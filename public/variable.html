<!doctype html>
<html lang="en">
  <head>
  </head>
  <body>
    <p>
      {{variable}}
    </p>
  </body>
  <script>
    // LIBRARY
    class Observable {
      constructor( value, callback ) {
        Object.defineProperty( window, value, {
          get( ) {
            console.log( 'get' )
            return this.value
          },
          set( value ) {
            console.log( 'set' )
            this.value = value
            callback( this.value )
          }
        } )
      }
    }

    function isVariable( data ) {
      const start = '\n      {{', end = '}}\n    '
      if ( data.startsWith( start ) & data.endsWith( end ) ) {
        return data.substring( 9, data.length - 7 )
      }
      return undefined
    }

    const elements = document.getElementsByTagName( '*' )

    for ( let element of elements ) {
      const VAR = isVariable( element.innerHTML )
      if ( VAR ) {
        new Observable( VAR, ( value ) => {
          element.innerHTML = value
        } )
      }
    }
  </script>
  <script>
    // USER
    variable = 'Hello..'
    setTimeout( ( ) => { variable = 'Hello World!' }, 2000 )
  </script>
</html>
